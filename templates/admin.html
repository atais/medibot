<!DOCTYPE html>
<html lang="pl">

<head>
    <title>MEDIBOT | Admin</title>
    {% include 'head.html' %}
</head>

<body>
{% include 'navbar.html' %}

<div class="container-fluid px-2 px-md-4 py-3">
    <div class="row g-4">
        <!-- Get Locations Section -->
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h2 class="h4 mb-3">Pobierz lokacje</h2>

                    {% if success_message %}
                    <div class="alert alert-success" role="alert">
                        <i class="bi bi-check-circle"></i> {{ success_message }}
                    </div>
                    {% endif %}

                    {% if error_message %}
                    <div class="alert alert-danger" role="alert">
                        <i class="bi bi-exclamation-triangle"></i> {{ error_message }}
                    </div>
                    {% endif %}

                    <form method="post" action="/admin/get-locations">
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-download"></i> Pobierz lokacje z API
                        </button>
                    </form>
                </div>
            </div>
        </div>

        {% if locations_data %}
        <!-- Locations Data Display Section -->
        <div class="col-12">
            <div class="card shadow-sm">
                <div class="card-body">
                    <h2 class="h4 mb-3">Dane lokacji</h2>
                    <div class="form-group">
                        <label for="locations-textbox" class="form-label">JSON Response:</label>
                        <textarea id="locations-textbox" class="form-control" rows="20" readonly>{{ locations_data }}</textarea>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-secondary" onclick="copyToClipboard()">
                            <i class="bi bi-clipboard"></i> Kopiuj do schowka
                        </button>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
<script>
function copyToClipboard() {
    const textArea = document.getElementById('locations-textbox');
    textArea.select();
    textArea.setSelectionRange(0, 99999); // For mobile devices
    document.execCommand('copy');

    // Show feedback
    const button = event.target.closest('button');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="bi bi-check"></i> Skopiowano!';
    setTimeout(() => {
        button.innerHTML = originalText;
    }, 2000);
}
</script>
</body>

</html>